let express,mongoose,morgan,path,getEnvironmentData,routes;_3f7‍.w("express",[["default",["express"],function(v){express=v}]]);_3f7‍.w("mongoose",[["default",["mongoose"],function(v){mongoose=v}]]);_3f7‍.w("morgan",[["default",["morgan"],function(v){morgan=v}]]);_3f7‍.w("path",[["default",["path"],function(v){path=v}]]);_3f7‍.w("worker_threads",[["getEnvironmentData",["getEnvironmentData"],function(v){getEnvironmentData=v}]]);_3f7‍.w("./routes/api",[["default",["routes"],function(v){routes=v}]]);





const app = express();
const PORT = 8080;



// function getAPI(url) {
//   try {
//     fetch(url)
//       .then((res) => res.json())
//       .then((data) => {
//         console.log("Fetch Berhasil");
//         return data;
//       });
//   } catch (err) {
//     throw err;
//   }
// }

// getEnvironmentData("https://data.covid19.go.id/public/api/update.json");

const MONGODB_URI =
  "mongodb+srv://jayamiko:qwerty114@coviddb.zl5n4.mongodb.net/myFirstDatabase?retryWrites=true&w=majority";

mongoose.connect(MONGODB_URI || "mongodb://localhost:8080/covid", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
});

mongoose.connection.on("connected", () => {
  console.log("Mongoose is connected!");
});

app.use(express.json());
app.use(express.urlencoded({extended: false}));

app.use(morgan("tiny"));
app.use("./api", routes);

app.listen(PORT, console.log(`Server is starting at ${PORT}`));
